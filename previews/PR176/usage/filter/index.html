<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Filtering · Neuroimaging.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroimaging.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../types/">Types</a></li><li><span class="tocitem">Usage/Implementation Details</span><ul><li><a class="tocitem" href="../access/">Accessing data</a></li><li class="is-active"><a class="tocitem" href>Filtering</a><ul class="internal"><li><a class="tocitem" href="#Import-example-EEG-data"><span>Import example EEG data</span></a></li><li><a class="tocitem" href="#Modality-specific-filter"><span>Modality specific filter</span></a></li><li><a class="tocitem" href="#Custom-defined-filter"><span>Custom defined filter</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li></ul></li><li><span class="tocitem">General EEG Processing</span><ul><li><a class="tocitem" href="../../eeg/eeg/">Overview</a></li><li><a class="tocitem" href="../../eeg/examples/">Example</a></li><li><a class="tocitem" href="../../eeg/functions/">API</a></li></ul></li><li><span class="tocitem">Steady State Responses (EEG)</span><ul><li><a class="tocitem" href="../../assr/assr/">Overview</a></li><li><a class="tocitem" href="../../assr/examples/">Example</a></li><li><a class="tocitem" href="../../assr/functions/">API</a></li></ul></li><li><span class="tocitem">Transient Responses (EEG)</span><ul><li><a class="tocitem" href="../../tr/transient/">Overview</a></li><li><a class="tocitem" href="../../tr/examples/">Example</a></li></ul></li><li><span class="tocitem">Coordinate Systems</span><ul><li><a class="tocitem" href="../../coord/examples/">Example</a></li></ul></li><li><span class="tocitem">Source Modelling</span><ul><li><a class="tocitem" href="../../source/examples/">Example</a></li></ul></li><li><a class="tocitem" href="../../IO/">Input/Output Support</a></li><li><a class="tocitem" href="../../api/">Low-Level API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage/Implementation Details</a></li><li class="is-active"><a href>Filtering</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Filtering</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rob-luke/Neuroimaging.jl/blob/master/docs/src/usage/filter.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h1><p><code>Neuroimaging.jl</code> provides a flexible filtering interface with sane defaults for different data and experimental types, this is achieved by providing a light wrapper over the <code>DSP.jl</code> backend.</p><div class="admonition is-info"><header class="admonition-header">DSP.jl documentation</header><div class="admonition-body"><p>The filtering processes for this package are dependent on the <code>DSP.jl</code> package. As such, we recommend reading the  <a href="https://docs.juliadsp.org/stable/contents/">DSP.jl documentation</a> to understand the design choices used in this pacakge, and to utilise the ability to define custom filtering.</p></div></div><h2 id="Import-example-EEG-data"><a class="docs-heading-anchor" href="#Import-example-EEG-data">Import example EEG data</a><a id="Import-example-EEG-data-1"></a><a class="docs-heading-anchor-permalink" href="#Import-example-EEG-data" title="Permalink"></a></h2><p>To demonstrate the filtering capabilities of this package we first import some example data. For simplicity, we will simply process one channel of data in this example.</p><pre><code class="language-julia hljs">using Neuroimaging, DataDeps, StatsBase, Unitful

data_path = joinpath(
    datadep&quot;ExampleSSR&quot;,
    &quot;Neuroimaging.jl-example-data-master&quot;,
    &quot;neuroimaingSSR.bdf&quot;,
)

s = read_SSR(data_path)
s.data = s.data .- StatsBase.mean(s.data, dims=1) # remove DC offset for easier plotting
keep_channel!(s, &quot;F5&quot;)
s</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SSR measurement of 5.0 mins with 1 channels sampled at 8192.0 Hz
  Modulation frequency: NaN Hz
</code></pre><h2 id="Modality-specific-filter"><a class="docs-heading-anchor" href="#Modality-specific-filter">Modality specific filter</a><a id="Modality-specific-filter-1"></a><a class="docs-heading-anchor-permalink" href="#Modality-specific-filter" title="Permalink"></a></h2><p><code>Neuroimaging.jl</code> provides standard filter functions for each data type and experimental design type. This allows you to quickly get started with sane filtering parameters. First we demonstrate the standard filtering functions applied to two data types. Then, below we demonstrate how to apply a custom defined filter to any <code>Neuroimaging.jl</code> type.</p><h3 id="SSR"><a class="docs-heading-anchor" href="#SSR">SSR</a><a id="SSR-1"></a><a class="docs-heading-anchor-permalink" href="#SSR" title="Permalink"></a></h3><p>The <a href="../../assr/assr/#ssr_intro">steady state response</a> type uses a third order Butterworth filter with a 2 Hz cutoff by default. The filter is applied twice to achieve zero phase filtering, by using the <code>filtfilt</code> function from DSP.jl.</p><pre><code class="language- hljs">using Plots

s_hp = filter_highpass(s)

plot(data(s), label=&quot;Original Signal&quot;)
plot!(data(s_hp), label=&quot;Filtered Signal&quot;)
current() |&gt; DisplayAs.PNG # hide</code></pre><h3 id="EEG"><a class="docs-heading-anchor" href="#EEG">EEG</a><a id="EEG-1"></a><a class="docs-heading-anchor-permalink" href="#EEG" title="Permalink"></a></h3><p>For general EEG types a FIR filter is utilised with a Hamming window. By default zero phase filtering is applied by compensating for the delay of the filter.</p><pre><code class="language- hljs">s2 = read_EEG(data_path)
s2.data = s2.data .- StatsBase.mean(s2.data, dims=1) # remove DC offset for better plotting
keep_channel!(s2, &quot;F5&quot;)

s_hp = filter_highpass(s2, cutOff = 2u&quot;Hz&quot;)
s_lp = filter_lowpass(s2, cutOff = 5u&quot;Hz&quot;) # extreme value to show LP effect in plot

plot(data(s2), label=&quot;raw&quot;)
plot!(data(s_hp), label=&quot;highpass&quot;)
plot!(data(s_lp), label=&quot;lowpass&quot;)
current() |&gt; DisplayAs.PNG # hide</code></pre><h2 id="Custom-defined-filter"><a class="docs-heading-anchor" href="#Custom-defined-filter">Custom defined filter</a><a id="Custom-defined-filter-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-defined-filter" title="Permalink"></a></h2><p>In addition to the default filtering above, <code>Neuroimaging.jl</code> provides the user completely flexibility in filtering the data by allowing standard <code>DSP.jl</code> objects to be used directly on data types. The functions <code>filt</code> and <code>filtfilt</code> are both exposed to the user and work with all <code>Neuroimaging.jl</code> data types.</p><p>In this example a custom zero pole gain implementation of a 6th order  Butterworth filter is applied to the SSR data. The filter is applied using both the zero-phase <code>filtfilt</code> approach and the standard <code>filt</code>.</p><pre><code class="language- hljs">using DSP
responsetype =  Highpass(3, fs = samplingrate(Float64, s))
designmethod =  Butterworth(6)
zpg = digitalfilter(responsetype, designmethod)

# Apply filtering using each exposed method
s_custom_filtfilt = Neuroimaging.filtfilt(s, zpg) 
s_custom_filt = Neuroimaging.filt(s, zpg) 

s = trim_channel(s, 10000)
s_custom_filtfilt = trim_channel(s_custom_filtfilt, 10000)
s_custom_filt = trim_channel(s_custom_filt, 10000)

plot(data(s), label=&quot;raw&quot;)
plot!(data(s_custom_filtfilt), label=&quot;filtfilt&quot;)
plot!(data(s_custom_filt), label=&quot;filt&quot;)
current() |&gt; DisplayAs.PNG # hide</code></pre><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>We have demonstrated how to apply standard and custom filtering to your neuroimaging data. If your specific experimental design data has a common filtering specification that is not yet included in <code>Neuroimaging.jl</code>, then please raise an issue on the GitHub page and we can add support for your data type.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../access/">« Accessing data</a><a class="docs-footer-nextpage" href="../../eeg/eeg/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.7 on <span class="colophon-date" title="Saturday 2 October 2021 08:15">Saturday 2 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
